(this["webpackJsonpxlsx-merge-for-timashoff"]=this["webpackJsonpxlsx-merge-for-timashoff"]||[]).push([[0],{15:function(e,a){},18:function(e,a,t){e.exports={button:"style_button__1PJKE"}},24:function(e,a,t){},3:function(e,a,t){e.exports={app:"style_app__3zg94",header:"style_header__3Q95X",main:"style_main___Jt4a",mainForm:"style_mainForm__bZgzH",label:"style_label__1hM64",labelText:"style_labelText__cNTSe",input:"style_input__3czM7",buttons:"style_buttons__3Kleu"}},31:function(e,a){},32:function(e,a){},34:function(e,a,t){"use strict";t.r(a);var n,o=t(7),i=t(16),l=t.n(i),c=(t(24),t(0)),r=t(19),s=t(5),d=t.n(s),O=t(2),_=t(10),f=t(6),p=t(4);!function(e){e.SET_ORIG_TEXT="SET_ORIG_TEXT",e.SET_ORIG_VALUE="SET_ORIG_VALUE",e.SET_ORIG_LOADING="SET_ORIG_LOADING",e.SET_ORIG_LOADED="SET_ORIG_LOADED",e.SET_ORIG_DATA="SET_ORIG_DATA",e.SET_WORKBOOK="SET_WORKBOOK",e.SET_MAP="SET_MAP",e.SET_WRONG_FILE_FORMAT="SET_WRONG_FILE_FORMAT",e.SET_DIFF_TEXT="SET_DIFF_TEXT",e.SET_DIFF_VALUE="SET_DIFF_VALUE",e.SET_DIFF_LOADING="SET_DIFF_LOADING",e.SET_DIFF_LOADED="SET_DIFF_LOADED",e.SET_DIFF_DATA="SET_DIFF_DATA",e.SET_DOWNLOAD_DISABLED="SET_DOWNLOAD_DISABLED",e.RESET_APP="RESET_APP",e.UPLOAD_TEMPLATE="UPLOAD_TEMPLATE",e.UPLOAD_TEMPLATE_SUCCESS="UPLOAD_TEMPLATE_SUCCESS",e.UPLOAD_TEMPLATE_FAIL="UPLOAD_TEMPLATE_FAIL",e.SAVE_TEMPLATE_DATA="SAVE_TEMPLATE_DATA"}(n||(n={}));var u=function(e){return{type:n.SET_ORIG_TEXT,payload:e}},T=function(e){return{type:n.SET_ORIG_LOADING,payload:e}},b=function(e){return{type:n.SET_ORIG_LOADED,payload:e}},E=function(e){return{type:n.SET_ORIG_DATA,payload:e}},j=function(e){return{type:n.SET_WORKBOOK,payload:e}},D=function(e){return{type:n.SET_MAP,payload:e}},m=function(e){return{type:n.SET_WRONG_FILE_FORMAT,payload:e}},A=function(e){return{type:n.SET_DIFF_TEXT,payload:e}},L=function(e){return{type:n.SET_DIFF_LOADING,payload:e}},S=function(e){return{type:n.SET_DIFF_LOADED,payload:e}},g=function(e){return{type:n.SET_DOWNLOAD_DISABLED,payload:e}},y={origText:"",origValue:"",isOrigLoading:!1,origLoaded:!1,origData:[],workBook:null,map:{},wrongFileFormat:!1,diffText:"",diffValue:"",isDiffLoading:!1,diffLoaded:!1,diffData:[],downloadIsDisabled:!0,isTemplateLoading:!1,templateLoaded:!1,templateFileName:"",templateItem:{},templateData:[],templateWorkBook:null},F=function(){var e,a,t,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,l=arguments.length>1?arguments[1]:void 0;return(o={},Object(O.a)(o,n.SET_ORIG_TEXT,Object(c.a)(Object(c.a)({},i),{},{origText:l.payload})),Object(O.a)(o,n.SET_ORIG_VALUE,Object(c.a)(Object(c.a)({},i),{},{origValue:l.payload})),Object(O.a)(o,n.SET_ORIG_LOADING,Object(c.a)(Object(c.a)({},i),{},{isOrigLoading:l.payload})),Object(O.a)(o,n.SET_ORIG_LOADED,Object(c.a)(Object(c.a)({},i),{},{origLoaded:l.payload})),Object(O.a)(o,n.SET_ORIG_DATA,Object(c.a)(Object(c.a)({},i),{},{origData:l.payload})),Object(O.a)(o,n.SET_WORKBOOK,Object(c.a)(Object(c.a)({},i),{},{workBook:l.payload})),Object(O.a)(o,n.SET_MAP,Object(c.a)(Object(c.a)({},i),{},{map:l.payload})),Object(O.a)(o,n.SET_WRONG_FILE_FORMAT,Object(c.a)(Object(c.a)({},i),{},{wrongFileFormat:l.payload})),Object(O.a)(o,n.SET_DIFF_TEXT,Object(c.a)(Object(c.a)({},i),{},{diffText:l.payload})),Object(O.a)(o,n.SET_DIFF_VALUE,Object(c.a)(Object(c.a)({},i),{},{diffValue:l.payload})),Object(O.a)(o,n.SET_DIFF_LOADING,Object(c.a)(Object(c.a)({},i),{},{isDiffLoading:l.payload})),Object(O.a)(o,n.SET_DIFF_LOADED,Object(c.a)(Object(c.a)({},i),{},{diffLoaded:l.payload})),Object(O.a)(o,n.SET_DIFF_DATA,Object(c.a)(Object(c.a)({},i),{},{diffData:l.payload})),Object(O.a)(o,n.SET_DOWNLOAD_DISABLED,Object(c.a)(Object(c.a)({},i),{},{downloadIsDisabled:l.payload})),Object(O.a)(o,n.UPLOAD_TEMPLATE,Object(c.a)(Object(c.a)({},i),{},{downloadIsDisabled:!1,isTemplateLoading:!0})),Object(O.a)(o,n.UPLOAD_TEMPLATE_SUCCESS,Object(c.a)(Object(c.a)({},i),{},{isTemplateLoading:!1,templateFileName:null===(e=l.payload)||void 0===e?void 0:e.fileName,templateItem:null===(a=l.payload)||void 0===a?void 0:a.data,templateWorkBook:null===(t=l.payload)||void 0===t?void 0:t.workBook,templateLoaded:!0})),Object(O.a)(o,n.UPLOAD_TEMPLATE_FAIL,Object(c.a)(Object(c.a)({},i),{},{isTemplateLoading:!1,templateLoaded:!1})),Object(O.a)(o,n.SAVE_TEMPLATE_DATA,Object(c.a)(Object(c.a)({},i),{},{templateData:l.payload})),Object(O.a)(o,n.RESET_APP,Object(c.a)(Object(c.a)({},i),y)),o)[l.type]||i},x=function(e,a){return e.SheetNames[a]},I=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(t,n){var o=new FileReader;o.readAsArrayBuffer(e),o.onload=function(){var e=o.result,n=Object(p.read)(e,{type:"buffer"}),i=n.Sheets[n.SheetNames[a]],l=p.utils.sheet_to_json(i,{defval:""});t([l,n])},o.onerror=function(){console.log("error",o.error),n(o.error)}}))},v=function(){var e=Object(o.useReducer)(F,y),a=Object(f.a)(e,2),t=a[0],i=a[1],l=t.origText,s=t.origValue,v=t.isOrigLoading,h=t.origLoaded,N=t.origData,P=t.workBook,R=t.map,k=t.wrongFileFormat,w=t.diffText,G=t.diffValue,M=t.isDiffLoading,V=t.diffLoaded,B=t.diffData,W=t.downloadIsDisabled,K=t.isTemplateLoading,X=t.templateFileName,J=t.templateLoaded,z=function(){var e=Object(_.a)(d.a.mark((function e(a){var t,o,l,c,r,s,_;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=30;break}return i(g(!0)),i(m(!1)),i(u(a.target.files[0].name)),o=a.target.files[0],i(T(!0)),e.prev=6,e.next=9,I(o);case 9:l=e.sent,c=Object(f.a)(l,2),r=c[0],s=c[1],i(E(r)),i(j(s)),_=r.reduce((function(e,a,t){return a.model&&a.model.trim()&&Object.assign(e,Object(O.a)({},a.model.trim(),t)),e}),{}),console.log(r),Object.keys(_).length?(i(D(_)),i(b(!0))):(i(m(!0)),i(b(!1))),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(6),console.log(e.t0),i(b(!1));case 25:return e.prev=25,i(T(!1)),e.finish(25);case 28:e.next=33;break;case 30:i(u("")),i((d="",{type:n.SET_ORIG_VALUE,payload:d})),i(b(!1));case 33:case"end":return e.stop()}var d}),e,null,[[6,21,25,28]])})));return function(a){return e.apply(this,arguments)}}(),Y=function(){var e=Object(_.a)(d.a.mark((function e(a){var t,o,l,c,r,s,O,_;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=20;break}return i({type:"UPLOAD_TEMPLATE",payload:void 0}),o=a.target.files[0],l=a.target.files[0].name,e.prev=4,e.next=7,I(o,1);case 7:c=e.sent,r=Object(f.a)(c,2),s=Object(f.a)(r[0],1),O=s[0],_=r[1],console.log(O,_),i((d={data:O,fileName:l,workBook:_},{type:n.UPLOAD_TEMPLATE_SUCCESS,payload:d})),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),console.log(e.t0),i({type:n.UPLOAD_TEMPLATE_FAIL,payload:void 0});case 20:case"end":return e.stop()}var d}),e,null,[[4,16]])})));return function(a){return e.apply(this,arguments)}}();return{onSubmit:function(e){return e.preventDefault()},origValue:s,onOrigChange:z,isOrigLoading:v,origLoaded:h,origText:l,wrongFileFormat:k,diffValue:G,diffText:w,onDiffChange:function(){var e=Object(_.a)(d.a.mark((function e(a){var t,o,l,c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=24;break}return i(g(!0)),i(A(a.target.files[0].name)),o=a.target.files[0],i(L(!0)),e.prev=5,e.next=8,I(o);case 8:l=e.sent,c=Object(f.a)(l,1),r=c[0],i((d=r,{type:n.SET_DIFF_DATA,payload:d})),i(S(!0)),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),console.log(e.t0),i(S(!1));case 19:return e.prev=19,i(L(!1)),e.finish(19);case 22:e.next=27;break;case 24:i(A("")),i((s="",{type:n.SET_DIFF_VALUE,payload:s})),i(S(!1));case 27:case"end":return e.stop()}var s,d}),e,null,[[5,15,19,22]])})));return function(a){return e.apply(this,arguments)}}(),isDiffLoading:M,diffLoaded:V,onProcessClick:function(){var e=B.reduce((function(e,a){var t=a[U],n=a[C];"string"===typeof t&&t.trim()&&"number"===typeof n&&void 0!==R[t.trim()]&&(e.newData[R[t.trim()]].quantity=n);return e}),{newData:Object(r.a)(N),templateDate:{}}),a=e.newData;e.templateDate;if(i(E(a)),null!==P){var t=Object(c.a)({},P),n=x(P,0),o=Object(c.a)({},function(e,a){return e.Sheets[x(e,a)]}(P,0));p.utils.sheet_add_json(o,N),p.utils.book_append_sheet(t,o,n),i(j(t))}i(g(!1))},onSaveFileClick:function(){P&&Object(p.writeFile)(P,"new_".concat(l)),i({type:n.RESET_APP,payload:void 0})},downloadIsDisabled:W,onTemplateUpload:Y,isTemplateLoading:K,templateFileName:X,templateLoaded:J}},h=t(17),N=t.n(h),P=t(18),R=t.n(P),k=t(1),w=function(e){var a=e.icon,t=e.disabled,n=e.onClick;return Object(k.jsx)("button",{className:R.a.button,type:"submit",disabled:t,onClick:n,children:Object(k.jsx)("i",{className:N()("fas ",a)})})},G=t(3),M=t.n(G),U="__EMPTY_2",C="__EMPTY_5",V=function(){var e=v(),a=e.onSubmit,t=e.origValue,n=e.onOrigChange,o=e.isOrigLoading,i=e.origLoaded,l=e.origText,c=e.wrongFileFormat,r=e.diffValue,s=e.diffText,d=e.onDiffChange,O=e.isDiffLoading,_=e.diffLoaded,f=e.onProcessClick,p=e.onSaveFileClick,u=e.downloadIsDisabled,T=e.onTemplateUpload,b=e.isTemplateLoading,E=e.templateFileName,j=e.templateLoaded;return Object(k.jsxs)("div",{className:M.a.app,children:[Object(k.jsx)("header",{className:M.a.header}),Object(k.jsx)("main",{className:M.a.main,children:Object(k.jsxs)("form",{action:"",className:M.a.mainForm,onSubmit:a,children:[Object(k.jsxs)("label",{className:M.a.label,children:[Object(k.jsx)("input",{type:"file",className:M.a.input,onChange:n,accept:".xlsx",value:t}),Object(k.jsx)("span",{className:M.a.labelText,children:o?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":(c?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442":l)||"\u041c\u043e\u0439 \u0448\u0430\u0431\u043b\u043e\u043d"}),o?Object(k.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(k.jsx)("i",{className:"fas fa-file-excel"})]}),Object(k.jsxs)("label",{className:M.a.label,children:[Object(k.jsx)("input",{type:"file",className:M.a.input,onChange:d,accept:".xlsx",value:r}),Object(k.jsx)("span",{className:M.a.labelText,children:O?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":s||"\u041e\u0441\u0442\u0430\u0442\u043a\u0438"}),O?Object(k.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(k.jsx)("i",{className:"fas fa-file-excel"})]}),Object(k.jsxs)("label",{className:M.a.label,children:[Object(k.jsx)("input",{type:"file",className:M.a.input,onChange:T,accept:".xlsx",value:""}),Object(k.jsx)("span",{className:M.a.labelText,children:b?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":E||"\u0428\u0430\u0431\u043b\u043e\u043d \u041e\u0437\u043e\u043d"}),b?Object(k.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(k.jsx)("i",{className:"fas fa-file-excel"})]}),Object(k.jsxs)("div",{className:M.a.buttons,children:[Object(k.jsx)(w,{icon:"fa-cogs",disabled:!(i&&_&&j),onClick:f}),Object(k.jsx)(w,{icon:"fa-file-download",disabled:!i||!_||!j||u,onClick:p})]})]})})]})};l.a.render(Object(k.jsx)(V,{}),document.getElementById("root"))}},[[34,1,2]]]);