(this["webpackJsonpxlsx-merge-for-timashoff"]=this["webpackJsonpxlsx-merge-for-timashoff"]||[]).push([[0],{13:function(e,t){},17:function(e,t,a){e.exports={button:"style_button__1H5Da"}},23:function(e,t,a){},3:function(e,t,a){e.exports={app:"style_app__1DjLB",header:"style_header__nAvKQ",main:"style_main__sl9V2",mainForm:"style_mainForm__2wspV",mainLabel:"style_mainLabel__2QR-1",diffLabel:"style_diffLabel__2Ti5i",labelText:"style_labelText__3fBC7",mainFile:"style_mainFile__2F-8Z",diffFile:"style_diffFile__1MXOS",input:"style_input__1u9k0",buttons:"style_buttons__3qzBG"}},30:function(e,t){},31:function(e,t){},33:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a(14),c=a.n(s),r=(a(23),a(18)),i=a(6),l=a.n(i),o=a(15),b=a(11),u=a(2),f=a(5),j=a(16),m=a.n(j),O=a(17),d=a.n(O),p=a(0),x=function(e){var t=e.icon,a=e.disabled,n=e.onClick;return Object(p.jsx)("button",{className:d.a.button,type:"submit",disabled:a,onClick:n,children:Object(p.jsx)("i",{className:m()("fas ",t)})})},_=function(e){return new Promise((function(t,a){var n=new FileReader;n.readAsArrayBuffer(e),n.onload=function(){var e=n.result,a=Object(f.read)(e,{type:"buffer"}),s=a.Sheets[a.SheetNames[0]],c=f.utils.sheet_to_json(s);t([c,a])},n.onerror=function(){console.log("error",n.error),a(n.error)}}))},h=a(3),v=a.n(h),y=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(!1),i=Object(u.a)(c,2),j=i[0],m=i[1],O=Object(n.useState)(!1),d=Object(u.a)(O,2),h=d[0],y=d[1],g=Object(n.useState)([]),N=Object(u.a)(g,2),S=N[0],k=N[1],w=Object(n.useState)(null),F=Object(u.a)(w,2),C=F[0],L=F[1],T=Object(n.useState)({}),A=Object(u.a)(T,2),B=A[0],D=A[1],E=Object(n.useState)(!1),M=Object(u.a)(E,2),P=M[0],q=M[1],J=Object(n.useState)(""),Q=Object(u.a)(J,2),R=Q[0],V=Q[1],Y=Object(n.useState)(!1),z=Object(u.a)(Y,2),G=z[0],H=z[1],I=Object(n.useState)(!1),K=Object(u.a)(I,2),X=K[0],Z=K[1],U=Object(n.useState)([]),W=Object(u.a)(U,2),$=W[0],ee=W[1],te=Object(n.useState)(!0),ae=Object(u.a)(te,2),ne=ae[0],se=ae[1],ce=function(){var e=Object(b.a)(l.a.mark((function e(t){var a,n,c,r,i,b,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(a=t.target.files)||void 0===a?void 0:a.length)){e.next=27;break}return q(!1),s(t.target.files[0].name),n=t.target.files[0],m(!0),e.prev=5,e.next=8,_(n);case 8:c=e.sent,r=Object(u.a)(c,2),i=r[0],b=r[1],k(i),L(b),f=Array.isArray(i)?i.reduce((function(e,t,a){return t.model&&t.model.trim()&&Object.assign(e,Object(o.a)({},t.model.trim(),a)),e}),{}):{},Object.keys(f).length?(console.log(f),D(f),y(!0)):(q(!0),y(!1)),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),console.log(e.t0),y(!1);case 22:return e.prev=22,m(!1),e.finish(22);case 25:e.next=29;break;case 27:s(""),y(!1);case 29:case"end":return e.stop()}}),e,null,[[5,18,22,25]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(b.a)(l.a.mark((function e(t){var a,n,s,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(a=t.target.files)||void 0===a?void 0:a.length)){e.next=23;break}return V(t.target.files[0].name),n=t.target.files[0],H(!0),e.prev=4,e.next=7,_(n);case 7:s=e.sent,c=Object(u.a)(s,1),r=c[0],ee(r),Z(!0),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0),Z(!1);case 18:return e.prev=18,H(!1),e.finish(18);case 21:e.next=25;break;case 23:V(""),Z(!1);case 25:case"end":return e.stop()}}),e,null,[[4,14,18,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:v.a.app,children:[Object(p.jsx)("header",{className:v.a.header}),Object(p.jsx)("main",{className:v.a.main,children:Object(p.jsxs)("form",{action:"",className:v.a.mainForm,onSubmit:function(e){return e.preventDefault()},children:[Object(p.jsxs)("label",{className:v.a.mainLabel,children:[Object(p.jsx)("input",{type:"file",className:v.a.mainFile,onChange:ce,accept:".xlsx"}),Object(p.jsx)("span",{className:v.a.labelText,children:j?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":(P?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442":a)||"\u042d\u0442\u0430\u043b\u043e\u043d"}),j?Object(p.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(p.jsx)("i",{className:"fas fa-file-excel"})]}),Object(p.jsxs)("label",{className:v.a.diffLabel,children:[Object(p.jsx)("input",{type:"file",className:v.a.diffFile,onChange:re,accept:".xlsx"}),Object(p.jsx)("span",{className:v.a.labelText,children:G?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":R||"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"}),G?Object(p.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(p.jsx)("i",{className:"fas fa-file-excel"})]}),Object(p.jsxs)("div",{className:v.a.buttons,children:[Object(p.jsx)(x,{icon:"fa-cog",disabled:!h||!X,onClick:function(){var e=$.reduce((function(e,t){var a=t.__EMPTY_5,n=B[(t.__EMPTY_2||"").trim()];return n&&"number"===typeof n&&(e[n].quantity=a),e}),Object(r.a)(S));k(e),se(!1)}}),Object(p.jsx)(x,{icon:"fa-file-download",disabled:ne,onClick:function(){C&&(C.Sheets[C.SheetNames[0]]=S,Object(f.writeFile)(C,"new_".concat(a)))}})]})]})})]})};c.a.render(Object(p.jsx)(y,{}),document.getElementById("root"))}},[[33,1,2]]]);