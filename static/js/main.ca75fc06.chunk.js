(this["webpackJsonpxlsx-merge-for-timashoff"]=this["webpackJsonpxlsx-merge-for-timashoff"]||[]).push([[0],{15:function(e,a){},19:function(e,a,t){e.exports={button:"style_button__1H5Da"}},24:function(e,a,t){},3:function(e,a,t){e.exports={app:"style_app__1DjLB",header:"style_header__nAvKQ",menu:"style_menu__2NK1j",main:"style_main__sl9V2",mainForm:"style_mainForm__2wspV",mainLabel:"style_mainLabel__2QR-1",diffLabel:"style_diffLabel__2Ti5i",labelText:"style_labelText__3fBC7",mainFile:"style_mainFile__2F-8Z",diffFile:"style_diffFile__1MXOS",input:"style_input__1u9k0",buttons:"style_buttons__3qzBG",logs:"style_logs__3z0FN",logsTitle:"style_logsTitle__251z6",logsTitleText:"style_logsTitleText__2AA9P",logsTitleButtons:"style_logsTitleButtons__1oUr-",eraseButton:"style_eraseButton__x6vzf",logsBody:"style_logsBody__1aKUL",log:"style_log__6_knb"}},31:function(e,a){},32:function(e,a){},34:function(e,a,t){"use strict";t.r(a);var n,o=t(5),l=t(16),c=t.n(l),s=(t(24),t(7)),i=t.n(s),r=t(2),_=t(13),d=t(9),O=t(6),f=t(17);!function(e){e.SET_ORIG_TEXT="SET_ORIG_TEXT",e.SET_ORIG_VALUE="SET_ORIG_VALUE",e.SET_ORIG_LOADING="SET_ORIG_LOADING",e.SET_ORIG_LOADED="SET_ORIG_LOADED",e.SET_ORIG_DATA="SET_ORIG_DATA",e.SET_WORKBOOK="SET_WORKBOOK",e.SET_MAP="SET_MAP",e.SET_WRONG_FILE_FORMAT="SET_WRONG_FILE_FORMAT",e.SET_DIFF_TEXT="SET_DIFF_TEXT",e.SET_DIFF_VALUE="SET_DIFF_VALUE",e.SET_DIFF_LOADING="SET_DIFF_LOADING",e.SET_DIFF_LOADED="SET_DIFF_LOADED",e.SET_DIFF_DATA="SET_DIFF_DATA",e.SET_DOWNLOAD_DISABLED="SET_DOWNLOAD_DISABLED",e.SET_LOG_VALUE="SET_LOG_VALUE",e.CLEAR_LOG="CLEAR_LOG",e.SET_MODAL_OPENED="SET_MODAL_OPENED",e.RESET_APP="RESET_APP"}(n||(n={}));var b=function(e){return{type:n.SET_ORIG_TEXT,payload:e}},u=function(e){return{type:n.SET_ORIG_VALUE,payload:e}},j=function(e){return{type:n.SET_ORIG_LOADING,payload:e}},p=function(e){return{type:n.SET_ORIG_LOADED,payload:e}},T=function(e){return{type:n.SET_ORIG_DATA,payload:e}},E=function(e){return{type:n.SET_MAP,payload:e}},g=function(e){return{type:n.SET_WRONG_FILE_FORMAT,payload:e}},m=function(e){return{type:n.SET_DIFF_TEXT,payload:e}},D=function(e){return{type:n.SET_DIFF_VALUE,payload:e}},x=function(e){return{type:n.SET_DIFF_LOADING,payload:e}},y=function(e){return{type:n.SET_DIFF_LOADED,payload:e}},L=function(e){return{type:n.SET_DOWNLOAD_DISABLED,payload:e}},S=function(e){return{type:n.SET_LOG_VALUE,payload:e}},h=function(e){return{type:n.SET_MODAL_OPENED,payload:e}},A=t(1),F=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;return(e={},Object(r.a)(e,n.SET_ORIG_TEXT,Object(A.a)(Object(A.a)({},a),{},{origText:t.payload})),Object(r.a)(e,n.SET_ORIG_VALUE,Object(A.a)(Object(A.a)({},a),{},{origValue:t.payload})),Object(r.a)(e,n.SET_ORIG_LOADING,Object(A.a)(Object(A.a)({},a),{},{isOrigLoading:t.payload})),Object(r.a)(e,n.SET_ORIG_LOADED,Object(A.a)(Object(A.a)({},a),{},{origLoaded:t.payload})),Object(r.a)(e,n.SET_ORIG_DATA,Object(A.a)(Object(A.a)({},a),{},{origData:t.payload})),Object(r.a)(e,n.SET_WORKBOOK,Object(A.a)(Object(A.a)({},a),{},{workBook:t.payload})),Object(r.a)(e,n.SET_MAP,Object(A.a)(Object(A.a)({},a),{},{map:t.payload})),Object(r.a)(e,n.SET_WRONG_FILE_FORMAT,Object(A.a)(Object(A.a)({},a),{},{wrongFileFormat:t.payload})),Object(r.a)(e,n.SET_DIFF_TEXT,Object(A.a)(Object(A.a)({},a),{},{diffText:t.payload})),Object(r.a)(e,n.SET_DIFF_VALUE,Object(A.a)(Object(A.a)({},a),{},{diffValue:t.payload})),Object(r.a)(e,n.SET_DIFF_LOADING,Object(A.a)(Object(A.a)({},a),{},{isDiffLoading:t.payload})),Object(r.a)(e,n.SET_DIFF_LOADED,Object(A.a)(Object(A.a)({},a),{},{diffLoaded:t.payload})),Object(r.a)(e,n.SET_DIFF_DATA,Object(A.a)(Object(A.a)({},a),{},{diffData:t.payload})),Object(r.a)(e,n.SET_DOWNLOAD_DISABLED,Object(A.a)(Object(A.a)({},a),{},{downloadIsDisabled:t.payload})),Object(r.a)(e,n.SET_LOG_VALUE,Object(A.a)(Object(A.a)({},a),{},{logValue:a.logValue.concat(t.payload)})),Object(r.a)(e,n.CLEAR_LOG,Object(A.a)(Object(A.a)({},a),{},{logValue:[]})),Object(r.a)(e,n.SET_MODAL_OPENED,Object(A.a)(Object(A.a)({},a),{},{modalOpened:t.payload})),Object(r.a)(e,n.RESET_APP,Object(A.a)(Object(A.a)({},a),I)),e)[t.type]||a},I={origText:"",origValue:"",isOrigLoading:!1,origLoaded:!1,origData:[],workBook:null,map:{},wrongFileFormat:!1,diffText:"",diffValue:"",isDiffLoading:!1,diffLoaded:!1,diffData:[],downloadIsDisabled:!0,logValue:[],modalOpened:!1},N=function(e,a){return new Promise((function(t,n){var o=new FileReader;o.readAsArrayBuffer(e),o.onload=function(){var e=o.result,n=Object(O.read)(e,{type:"buffer"}),l=n.Sheets[n.SheetNames[0]],c=O.utils.sheet_to_json(l,a);t([c,n])},o.onerror=function(){console.log("error",o.error),n(o.error)}}))},v=function(){var e=Object(o.useReducer)(F,I),a=Object(d.a)(e,2),t=a[0],l=a[1],c=t.origText,s=t.origValue,A=t.isOrigLoading,v=t.origLoaded,k=t.origData,R=t.workBook,G=t.map,V=t.wrongFileFormat,B=t.diffText,w=t.diffValue,M=t.isDiffLoading,C=t.diffLoaded,P=t.diffData,U=t.downloadIsDisabled,W=t.logValue,K=t.modalOpened;return{onSubmit:function(e){return e.preventDefault()},origValue:s,onOrigChange:function(){var e=Object(_.a)(i.a.mark((function e(a){var t,o,c,s,_,O,f,m,D;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=37;break}return o=a.target.files[0],u(a.target.value),l(L(!0)),l(g(!1)),l(b(a.target.files[0].name)),l(j(!0)),c=Date.now(),l(S("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 ".concat(a.target.files[0].name))),e.prev=9,e.next=12,N(o,{defval:"",header:"A",range:2});case 12:s=e.sent,_=Object(d.a)(s,2),O=_[0],f=_[1],m=Date.now(),l(S("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0437\u0430 ".concat(m-c," \u043c\u0441"))),console.log(O),l(T(O)),l((i=f,{type:n.SET_WORKBOOK,payload:i})),D=O.reduce((function(e,a,t){return a.D&&a.D.trim()&&Object.assign(e,Object(r.a)({},a.D.trim(),t)),e}),{}),console.log(D),console.log(O.length-Object.keys(D).length),Object.keys(D).length?(l(E(D)),l(p(!0))):(l(g(!0)),l(p(!1))),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(9),console.log(e.t0),l(p(!1));case 32:return e.prev=32,l(j(!1)),e.finish(32);case 35:e.next=40;break;case 37:l(b("")),l(u("")),l(p(!1));case 40:case"end":return e.stop()}var i}),e,null,[[9,28,32,35]])})));return function(a){return e.apply(this,arguments)}}(),isOrigLoading:A,origLoaded:v,origText:c,wrongFileFormat:V,diffValue:w,diffText:B,onDiffChange:function(){var e=Object(_.a)(i.a.mark((function e(a){var t,o,c,s,r,_,O;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=30;break}return l(D(a.target.value)),l(L(!0)),l(m(a.target.files[0].name)),o=a.target.files[0],l(x(!0)),c=Date.now(),l(S("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 ".concat(a.target.files[0].name))),e.prev=8,e.next=11,N(o,{header:"A"});case 11:s=e.sent,r=Object(d.a)(s,1),_=r[0],O=Date.now(),console.log(_),l(S("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0437\u0430 ".concat(O-c," \u043c\u0441"))),l((i=_,{type:n.SET_DIFF_DATA,payload:i})),l(y(!0)),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(8),console.log(e.t0),l(y(!1));case 25:return e.prev=25,l(x(!1)),e.finish(25);case 28:e.next=33;break;case 30:l(m("")),l(D("")),l(y(!1));case 33:case"end":return e.stop()}var i}),e,null,[[8,21,25,28]])})));return function(a){return e.apply(this,arguments)}}(),isDiffLoading:M,diffLoaded:C,onProcessClick:function(){var e=0,a=Object(f.pluralize)(e,"\u043f\u043e\u0437\u0438\u0446\u0438\u044f","\u043f\u043e\u0437\u0438\u0446\u0438\u0438","\u043f\u043e\u0437\u0438\u0446\u0438\u0439"),t=P.reduce((function(a,t){var n=t[H],o=t[Y];if("string"===typeof n&&"number"===typeof o){var l=n.match(/\[(\d+)\]/);null!==l&&l[1].length&&void 0!==G[l[1]]&&(e++,a[G[l[1]]].K=o)}return a}),k.map((function(e){return e.K=0,e})));l(S("\u0411\u044b\u043b\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0438 \u0437\u0430\u043c\u0435\u043d\u0435\u043d\u043e ".concat(e," ").concat(a))),l(T(t)),null!==R&&O.utils.sheet_add_json(R.Sheets[R.SheetNames[0]],k,{skipHeader:!0,origin:1}),l(L(!1))},onSaveFileClick:function(){R&&Object(O.writeFile)(R,"new_".concat(c),{compression:!0}),l({type:n.RESET_APP})},downloadIsDisabled:U,logValue:W,onLogErase:function(){return l({type:n.CLEAR_LOG})},onModalOpen:function(){return l(h(!0))},onModalClose:function(){return l(h(!1))},modalOpened:K}},k=t(18),R=t.n(k),G=t(19),V=t.n(G),B=t(0),w=function(e){var a=e.icon,t=e.disabled,n=e.onClick;return Object(B.jsx)("button",{className:V.a.button,type:"submit",disabled:t,onClick:n,children:Object(B.jsx)("i",{className:R()("fas ",a)})})},M=t(4),C=t.n(M),P=function(e){var a=e.open,t=e.title,n=e.children,o=e.onModalClose;return a?Object(B.jsx)("div",{className:C.a.layer,onClick:o,children:Object(B.jsxs)("div",{className:C.a.modal,onClick:function(e){e.stopPropagation()},children:[Object(B.jsxs)("header",{className:C.a.header,children:[Object(B.jsx)("span",{className:C.a.title,children:t}),Object(B.jsx)("button",{className:C.a.close,onClick:o,children:Object(B.jsx)("i",{className:"fas fa-times"})})]}),Object(B.jsx)("div",{className:C.a.body,children:n}),Object(B.jsx)("footer",{className:C.a.footer})]})}):null},U=t(3),W=t.n(U),K=t(8),X=t.n(K),z=function(){return Object(B.jsx)("div",{className:X.a.item,children:Object(B.jsxs)("label",{className:X.a.checkBoxLabel,children:[Object(B.jsx)("input",{className:X.a.checkbox,type:"checkbox"}),Object(B.jsx)("span",{className:X.a.checkBoxLabelText,children:"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u043b\u043e\u0433\u0438"})]})})},H="B",Y="C",q=function(){var e=v(),a=e.onSubmit,t=e.origValue,n=e.onOrigChange,o=e.isOrigLoading,l=e.origLoaded,c=e.origText,s=e.wrongFileFormat,i=e.diffValue,r=e.diffText,_=e.onDiffChange,d=e.isDiffLoading,O=e.diffLoaded,f=e.onProcessClick,b=e.onSaveFileClick,u=e.downloadIsDisabled,j=e.logValue,p=e.onLogErase,T=e.onModalOpen,E=e.onModalClose,g=e.modalOpened;return Object(B.jsxs)("div",{className:W.a.app,children:[Object(B.jsx)("button",{className:W.a.menu,onClick:T,children:Object(B.jsx)("i",{className:"fas fa-bars"})}),Object(B.jsx)("header",{className:W.a.header}),Object(B.jsxs)("main",{className:W.a.main,children:[Object(B.jsxs)("form",{action:"",className:W.a.mainForm,onSubmit:a,children:[Object(B.jsxs)("label",{className:W.a.mainLabel,children:[Object(B.jsx)("input",{type:"file",className:W.a.mainFile,onChange:n,accept:".xlsx",value:t}),Object(B.jsx)("span",{className:W.a.labelText,children:o?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":(s?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442":c)||"\u042d\u0442\u0430\u043b\u043e\u043d"}),o?Object(B.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(B.jsx)("i",{className:"fas fa-file-excel"})]}),Object(B.jsxs)("label",{className:W.a.diffLabel,children:[Object(B.jsx)("input",{type:"file",className:W.a.diffFile,onChange:_,accept:".xlsx",value:i}),Object(B.jsx)("span",{className:W.a.labelText,children:d?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":r||"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"}),d?Object(B.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(B.jsx)("i",{className:"fas fa-file-excel"})]}),Object(B.jsxs)("div",{className:W.a.buttons,children:[Object(B.jsx)(w,{icon:"fa-cogs",disabled:!(l&&O),onClick:f}),Object(B.jsx)(w,{icon:"fa-file-download",disabled:!l||!O||u,onClick:b})]})]}),!!j.length&&Object(B.jsxs)("div",{className:W.a.logs,children:[Object(B.jsxs)("p",{className:W.a.logsTitle,children:[Object(B.jsx)("span",{className:W.a.logsTitleText,children:"\u041b\u043e\u0433\u0438:"}),Object(B.jsx)("span",{className:W.a.logsTitleButtons,children:Object(B.jsx)("button",{className:W.a.eraseButton,onClick:p,children:Object(B.jsx)("i",{className:"fas fa-eraser"})})})]}),Object(B.jsx)("div",{className:W.a.logsBody,children:j.map((function(e,a){return Object(B.jsx)("span",{className:W.a.log,children:e},a)}))})]}),Object(B.jsx)(P,{open:g,title:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",onModalClose:E,children:Object(B.jsx)(z,{})})]})]})};c.a.render(Object(B.jsx)(q,{}),document.getElementById("root"))},4:function(e,a,t){e.exports={layer:"Modal_layer__22knj",modal:"Modal_modal__P3_V5",header:"Modal_header__StajR",close:"Modal_close__3rW_Y",title:"Modal_title__kbqpq",body:"Modal_body__3Izuw",icon:"Modal_icon__elt47",message:"Modal_message__18Jvc",footer:"Modal_footer__15gFb",buttons:"Modal_buttons__SfsnY"}},8:function(e,a,t){e.exports={item:"style_item__3Vu_H",checkBoxLabel:"style_checkBoxLabel__3nOWY",checkbox:"style_checkbox__HuM7o",checkBoxLabelText:"style_checkBoxLabelText__2vfHY"}}},[[34,1,2]]]);