(this["webpackJsonpxlsx-merge-for-timashoff"]=this["webpackJsonpxlsx-merge-for-timashoff"]||[]).push([[0],{15:function(e,a){},18:function(e,a,t){e.exports={button:"style_button__1H5Da"}},24:function(e,a,t){},3:function(e,a,t){e.exports={app:"style_app__1DjLB",header:"style_header__nAvKQ",main:"style_main__sl9V2",mainForm:"style_mainForm__2wspV",mainLabel:"style_mainLabel__2QR-1",diffLabel:"style_diffLabel__2Ti5i",labelText:"style_labelText__3fBC7",mainFile:"style_mainFile__2F-8Z",diffFile:"style_diffFile__1MXOS",input:"style_input__1u9k0",buttons:"style_buttons__3qzBG"}},31:function(e,a){},32:function(e,a){},34:function(e,a,t){"use strict";t.r(a);var n,i=t(5),o=t(16),r=t.n(o),c=(t(24),t(19)),l=t(7),s=t.n(l),_=t(2),d=t(13),f=t(9),O=t(4);!function(e){e.SET_ORIG_TEXT="SET_ORIG_TEXT",e.SET_ORIG_VALUE="SET_ORIG_VALUE",e.SET_ORIG_LOADING="SET_ORIG_LOADING",e.SET_ORIG_LOADED="SET_ORIG_LOADED",e.SET_ORIG_DATA="SET_ORIG_DATA",e.SET_WORKBOOK="SET_WORKBOOK",e.SET_MAP="SET_MAP",e.SET_WRONG_FILE_FORMAT="SET_WRONG_FILE_FORMAT",e.SET_DIFF_TEXT="SET_DIFF_TEXT",e.SET_DIFF_VALUE="SET_DIFF_VALUE",e.SET_DIFF_LOADING="SET_DIFF_LOADING",e.SET_DIFF_LOADED="SET_DIFF_LOADED",e.SET_DIFF_DATA="SET_DIFF_DATA",e.SET_DOWNLOAD_DISABLED="SET_DOWNLOAD_DISABLED",e.RESET_APP="RESET_APP"}(n||(n={}));var u=function(e){return{type:n.SET_ORIG_TEXT,payload:e}},b=function(e){return{type:n.SET_ORIG_VALUE,payload:e}},T=function(e){return{type:n.SET_ORIG_LOADING,payload:e}},j=function(e){return{type:n.SET_ORIG_LOADED,payload:e}},E=function(e){return{type:n.SET_ORIG_DATA,payload:e}},p=function(e){return{type:n.SET_MAP,payload:e}},D=function(e){return{type:n.SET_WRONG_FILE_FORMAT,payload:e}},S=function(e){return{type:n.SET_DIFF_TEXT,payload:e}},F=function(e){return{type:n.SET_DIFF_VALUE,payload:e}},y=function(e){return{type:n.SET_DIFF_LOADING,payload:e}},g=function(e){return{type:n.SET_DIFF_LOADED,payload:e}},m=function(e){return{type:n.SET_DOWNLOAD_DISABLED,payload:e}},A=t(0),L=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;return(e={},Object(_.a)(e,n.SET_ORIG_TEXT,Object(A.a)(Object(A.a)({},a),{},{origText:t.payload})),Object(_.a)(e,n.SET_ORIG_VALUE,Object(A.a)(Object(A.a)({},a),{},{origValue:t.payload})),Object(_.a)(e,n.SET_ORIG_LOADING,Object(A.a)(Object(A.a)({},a),{},{isOrigLoading:t.payload})),Object(_.a)(e,n.SET_ORIG_LOADED,Object(A.a)(Object(A.a)({},a),{},{origLoaded:t.payload})),Object(_.a)(e,n.SET_ORIG_DATA,Object(A.a)(Object(A.a)({},a),{},{origData:t.payload})),Object(_.a)(e,n.SET_WORKBOOK,Object(A.a)(Object(A.a)({},a),{},{workBook:t.payload})),Object(_.a)(e,n.SET_MAP,Object(A.a)(Object(A.a)({},a),{},{map:t.payload})),Object(_.a)(e,n.SET_WRONG_FILE_FORMAT,Object(A.a)(Object(A.a)({},a),{},{wrongFileFormat:t.payload})),Object(_.a)(e,n.SET_DIFF_TEXT,Object(A.a)(Object(A.a)({},a),{},{diffText:t.payload})),Object(_.a)(e,n.SET_DIFF_VALUE,Object(A.a)(Object(A.a)({},a),{},{diffValue:t.payload})),Object(_.a)(e,n.SET_DIFF_LOADING,Object(A.a)(Object(A.a)({},a),{},{isDiffLoading:t.payload})),Object(_.a)(e,n.SET_DIFF_LOADED,Object(A.a)(Object(A.a)({},a),{},{diffLoaded:t.payload})),Object(_.a)(e,n.SET_DIFF_DATA,Object(A.a)(Object(A.a)({},a),{},{diffData:t.payload})),Object(_.a)(e,n.SET_DOWNLOAD_DISABLED,Object(A.a)(Object(A.a)({},a),{},{downloadIsDisabled:t.payload})),Object(_.a)(e,n.RESET_APP,Object(A.a)(Object(A.a)({},a),I)),e)[t.type]||a},I={origText:"",origValue:"",isOrigLoading:!1,origLoaded:!1,origData:[],workBook:null,map:{},wrongFileFormat:!1,diffText:"",diffValue:"",isDiffLoading:!1,diffLoaded:!1,diffData:[],downloadIsDisabled:!0},x=function(e){return new Promise((function(a,t){var n=new FileReader;n.readAsArrayBuffer(e),n.onload=function(){var e=n.result,t=Object(O.read)(e,{type:"buffer"}),i=t.Sheets[t.SheetNames[0]],o=O.utils.sheet_to_json(i,{defval:""});a([o,t])},n.onerror=function(){console.log("error",n.error),t(n.error)}}))},h=function(){var e=Object(i.useReducer)(L,I),a=Object(f.a)(e,2),t=a[0],o=a[1],r=t.origText,l=t.origValue,A=t.isOrigLoading,h=t.origLoaded,v=t.origData,R=t.workBook,N=t.map,G=t.wrongFileFormat,k=t.diffText,w=t.diffValue,V=t.isDiffLoading,P=t.diffLoaded,W=t.diffData,M=t.downloadIsDisabled;return{onSubmit:function(e){return e.preventDefault()},origValue:l,onOrigChange:function(){var e=Object(d.a)(s.a.mark((function e(a){var t,i,r,c,l,d,O;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=30;break}return b(a.target.value),o(m(!0)),o(D(!1)),o(u(a.target.files[0].name)),i=a.target.files[0],o(T(!0)),e.prev=7,e.next=10,x(i);case 10:r=e.sent,c=Object(f.a)(r,2),l=c[0],d=c[1],o(E(l)),o((s=d,{type:n.SET_WORKBOOK,payload:s})),O=l.reduce((function(e,a,t){return a.model&&a.model.trim()&&Object.assign(e,Object(_.a)({},a.model.trim(),t)),e}),{}),Object.keys(O).length?(o(p(O)),o(j(!0))):(o(D(!0)),o(j(!1))),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(7),console.log(e.t0),o(j(!1));case 25:return e.prev=25,o(T(!1)),e.finish(25);case 28:e.next=33;break;case 30:o(u("")),o(b("")),o(j(!1));case 33:case"end":return e.stop()}var s}),e,null,[[7,21,25,28]])})));return function(a){return e.apply(this,arguments)}}(),isOrigLoading:A,origLoaded:h,origText:r,wrongFileFormat:G,diffValue:w,diffText:k,onDiffChange:function(){var e=Object(d.a)(s.a.mark((function e(a){var t,i,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=a.target.files)||void 0===t?void 0:t.length)){e.next=25;break}return o(F(a.target.value)),o(m(!0)),o(S(a.target.files[0].name)),i=a.target.files[0],o(y(!0)),e.prev=6,e.next=9,x(i);case 9:r=e.sent,c=Object(f.a)(r,1),l=c[0],o((s=l,{type:n.SET_DIFF_DATA,payload:s})),o(g(!0)),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.log(e.t0),o(g(!1));case 20:return e.prev=20,o(y(!1)),e.finish(20);case 23:e.next=28;break;case 25:o(S("")),o(F("")),o(g(!1));case 28:case"end":return e.stop()}var s}),e,null,[[6,16,20,23]])})));return function(a){return e.apply(this,arguments)}}(),isDiffLoading:V,diffLoaded:P,onProcessClick:function(){var e=W.reduce((function(e,a){var t=a[B],n=a[C];return"string"===typeof t&&t.trim()&&"number"===typeof n&&void 0!==N[t.trim()]&&(e[N[t.trim()]].quantity=n),e}),Object(c.a)(v));o(E(e)),null!==R&&O.utils.sheet_add_json(R.Sheets[R.SheetNames[0]],v),o(m(!1))},onSaveFileClick:function(){R&&Object(O.writeFile)(R,"new_".concat(r)),o({type:n.RESET_APP,payload:void 0})},downloadIsDisabled:M}},v=t(17),R=t.n(v),N=t(18),G=t.n(N),k=t(1),w=function(e){var a=e.icon,t=e.disabled,n=e.onClick;return Object(k.jsx)("button",{className:G.a.button,type:"submit",disabled:t,onClick:n,children:Object(k.jsx)("i",{className:R()("fas ",a)})})},V=t(3),P=t.n(V),B="__EMPTY_2",C="__EMPTY_5",W=function(){var e=h(),a=e.onSubmit,t=e.origValue,n=e.onOrigChange,i=e.isOrigLoading,o=e.origLoaded,r=e.origText,c=e.wrongFileFormat,l=e.diffValue,s=e.diffText,_=e.onDiffChange,d=e.isDiffLoading,f=e.diffLoaded,O=e.onProcessClick,u=e.onSaveFileClick,b=e.downloadIsDisabled;return Object(k.jsxs)("div",{className:P.a.app,children:[Object(k.jsx)("header",{className:P.a.header}),Object(k.jsx)("main",{className:P.a.main,children:Object(k.jsxs)("form",{action:"",className:P.a.mainForm,onSubmit:a,children:[Object(k.jsxs)("label",{className:P.a.mainLabel,children:[Object(k.jsx)("input",{type:"file",className:P.a.mainFile,onChange:n,accept:".xlsx",value:t}),Object(k.jsx)("span",{className:P.a.labelText,children:i?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":(c?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442":r)||"\u042d\u0442\u0430\u043b\u043e\u043d"}),i?Object(k.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(k.jsx)("i",{className:"fas fa-file-excel"})]}),Object(k.jsxs)("label",{className:P.a.diffLabel,children:[Object(k.jsx)("input",{type:"file",className:P.a.diffFile,onChange:_,accept:".xlsx",value:l}),Object(k.jsx)("span",{className:P.a.labelText,children:d?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":s||"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"}),d?Object(k.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(k.jsx)("i",{className:"fas fa-file-excel"})]}),Object(k.jsxs)("div",{className:P.a.buttons,children:[Object(k.jsx)(w,{icon:"fa-cogs",disabled:!(o&&f),onClick:O}),Object(k.jsx)(w,{icon:"fa-file-download",disabled:!o||!f||b,onClick:u})]})]})})]})};r.a.render(Object(k.jsx)(W,{}),document.getElementById("root"))}},[[34,1,2]]]);