(this["webpackJsonpxlsx-merge-for-timashoff"]=this["webpackJsonpxlsx-merge-for-timashoff"]||[]).push([[0],{13:function(e,t){},17:function(e,t,a){e.exports={button:"style_button__1H5Da"}},23:function(e,t,a){},3:function(e,t,a){e.exports={app:"style_app__1DjLB",header:"style_header__nAvKQ",main:"style_main__sl9V2",mainForm:"style_mainForm__2wspV",mainLabel:"style_mainLabel__2QR-1",diffLabel:"style_diffLabel__2Ti5i",labelText:"style_labelText__3fBC7",mainFile:"style_mainFile__2F-8Z",diffFile:"style_diffFile__1MXOS",input:"style_input__1u9k0",buttons:"style_buttons__3qzBG"}},30:function(e,t){},31:function(e,t){},33:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a(14),c=a.n(s),r=(a(23),a(18)),i=a(6),l=a.n(i),o=a(15),u=a(11),b=a(2),f=a(4),j=a(16),m=a.n(j),_=a(17),O=a.n(_),d=a(0),p=function(e){var t=e.icon,a=e.disabled,n=e.onClick;return Object(d.jsx)("button",{className:O.a.button,type:"submit",disabled:a,onClick:n,children:Object(d.jsx)("i",{className:m()("fas ",t)})})},x=function(e){return new Promise((function(t,a){var n=new FileReader;n.readAsArrayBuffer(e),n.onload=function(){var e=n.result,a=Object(f.read)(e,{type:"buffer"}),s=a.Sheets[a.SheetNames[0]],c=f.utils.sheet_to_json(s,{defval:""});t([c,a])},n.onerror=function(){console.log("error",n.error),a(n.error)}}))},h=a(3),v=a.n(h),y=function(){var e=Object(n.useState)(""),t=Object(b.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(!1),i=Object(b.a)(c,2),j=i[0],m=i[1],_=Object(n.useState)(!1),O=Object(b.a)(_,2),h=O[0],y=O[1],g=Object(n.useState)([]),N=Object(b.a)(g,2),S=N[0],k=N[1],w=Object(n.useState)(null),F=Object(b.a)(w,2),T=F[0],C=F[1],L=Object(n.useState)({}),E=Object(b.a)(L,2),M=E[0],P=E[1],B=Object(n.useState)(!1),Y=Object(b.a)(B,2),A=Y[0],D=Y[1],q=Object(n.useState)(""),J=Object(b.a)(q,2),Q=J[0],R=J[1],V=Object(n.useState)(!1),z=Object(b.a)(V,2),G=z[0],H=z[1],I=Object(n.useState)(!1),K=Object(b.a)(I,2),X=K[0],Z=K[1],U=Object(n.useState)([]),W=Object(b.a)(U,2),$=W[0],ee=W[1],te=Object(n.useState)(!0),ae=Object(b.a)(te,2),ne=ae[0],se=ae[1],ce=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,c,r,i,u,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(a=t.target.files)||void 0===a?void 0:a.length)){e.next=28;break}return D(!1),s(t.target.files[0].name),n=t.target.files[0],m(!0),e.prev=5,e.next=8,x(n);case 8:c=e.sent,r=Object(b.a)(c,2),i=r[0],u=r[1],k(i),C(u),f=i.reduce((function(e,t,a){return t.model&&t.model.trim()&&Object.assign(e,Object(o.a)({},t.model.trim(),a)),e}),{}),Object.keys(f).length?(P(f),y(!0)):(D(!0),y(!1)),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),console.log(e.t0),y(!1);case 23:return e.prev=23,m(!1),e.finish(23);case 26:e.next=30;break;case 28:s(""),y(!1);case 30:case"end":return e.stop()}}),e,null,[[5,19,23,26]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,s,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(a=t.target.files)||void 0===a?void 0:a.length)){e.next=23;break}return R(t.target.files[0].name),n=t.target.files[0],H(!0),e.prev=4,e.next=7,x(n);case 7:s=e.sent,c=Object(b.a)(s,1),r=c[0],ee(r),Z(!0),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0),Z(!1);case 18:return e.prev=18,H(!1),e.finish(18);case 21:e.next=25;break;case 23:R(""),Z(!1);case 25:case"end":return e.stop()}}),e,null,[[4,14,18,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:v.a.app,children:[Object(d.jsx)("header",{className:v.a.header}),Object(d.jsx)("main",{className:v.a.main,children:Object(d.jsxs)("form",{action:"",className:v.a.mainForm,onSubmit:function(e){return e.preventDefault()},children:[Object(d.jsxs)("label",{className:v.a.mainLabel,children:[Object(d.jsx)("input",{type:"file",className:v.a.mainFile,onChange:ce,accept:".xlsx"}),Object(d.jsx)("span",{className:v.a.labelText,children:j?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":(A?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442":a)||"\u042d\u0442\u0430\u043b\u043e\u043d"}),j?Object(d.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(d.jsx)("i",{className:"fas fa-file-excel"})]}),Object(d.jsxs)("label",{className:v.a.diffLabel,children:[Object(d.jsx)("input",{type:"file",className:v.a.diffFile,onChange:re,accept:".xlsx"}),Object(d.jsx)("span",{className:v.a.labelText,children:G?"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f...":Q||"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"}),G?Object(d.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(d.jsx)("i",{className:"fas fa-file-excel"})]}),Object(d.jsxs)("div",{className:v.a.buttons,children:[Object(d.jsx)(p,{icon:"fa-cog",disabled:!h||!X,onClick:function(){var e=$.reduce((function(e,t){return"number"===typeof t.__EMPTY_5&&"string"===typeof t.__EMPTY_2&&M[t.__EMPTY_2.trim()]&&(e[M[t.__EMPTY_2.trim()]].quantity=t.__EMPTY_5),e}),Object(r.a)(S));k(e),T&&f.utils.sheet_add_json(T.Sheets[T.SheetNames[0]],S),se(!1)}}),Object(d.jsx)(p,{icon:"fa-file-download",disabled:ne,onClick:function(){return T&&Object(f.writeFile)(T,"new_".concat(a))}})]})]})})]})};c.a.render(Object(d.jsx)(y,{}),document.getElementById("root"))}},[[33,1,2]]]);